<!-- component-a.component.html -->
<div class="search-container">
  <input type="text" [(ngModel)]="searchTerm" (input)="onSearch()" placeholder="Search...">
  <button (click)="navigateUp()">↑</button>
  <button (click)="navigateDown()">↓</button>
  <button (click)="clearSearch()">×</button>
</div>

<div class="accordion">
  <div class="accordion-item" *ngFor="let item of accordionData; let i = index">
    <div class="accordion-header" 
         (click)="toggleItem(i)"
         [innerHTML]="item.title | highlight:searchTerm:searchService.currentActiveMatchIndex | async"
         [class.active-match]="isActiveMatch('componentA', i)">
    </div>
    <div class="accordion-content" 
         *ngIf="expandedItems[i]"
         [innerHTML]="item.content | highlight:searchTerm:searchService.currentActiveMatchIndex | async"
         [class.active-match]="isActiveMatch('componentA', i)">
    </div>
  </div>
</div>
////////////////
// highlight.pipe.ts
import { Pipe, PipeTransform, SecurityContext } from '@angular/core';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import { SearchService } from './search.service';

@Pipe({
  name: 'highlight'
})
export class HighlightPipe implements PipeTransform {
  constructor(private sanitizer: DomSanitizer, private searchService: SearchService) {}

  transform(value: string, searchTerm: string, activeIndex?: number): SafeHtml {
    if (!searchTerm || !value) {
      return value;
    }

    const re = new RegExp(searchTerm, 'gi');
    let matchCount = 0;
    
    const highlighted = value.replace(re, match => {
      const isActive = activeIndex === matchCount;
      matchCount++;
      return `<span class="highlight ${isActive ? 'active-highlight' : ''}">${match}</span>`;
    });

    return this.sanitizer.sanitize(SecurityContext.HTML, highlighted) || '';
  }
}
