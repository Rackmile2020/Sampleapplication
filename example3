  ngAfterViewInit() {
    // Wait until actually appended to body
    setTimeout(() => {
      if (!document.body.contains(this.dialogRef.nativeElement)) return;

      this.previouslyFocusedEl = document.activeElement as HTMLElement;

      // Create focus trap
      this.focusTrap = this.focusTrapFactory.create(this.dialogRef.nativeElement);

      // Give browser time to paint, then focus dialog
      requestAnimationFrame(() => {
        this.dialogRef.nativeElement.focus();
        this.focusTrap.focusInitialElementWhenReady();
      });
    });
  }
