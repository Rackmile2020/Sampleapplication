LoadSearch() {
  this.searchService.query$.subscribe((query) => {
    // Reset on each search
    this.sanitizedHtml = [];
    this.highlightedHeadings = [];

    if (!query) {
      // fallback: keep original values when query is empty
      this.whatsCoveredData?.benefits?.forEach((item, index) => {
        this.highlightedHeadings[index] = this.toTitleCaseIfAllCaps(item?.heading);
        this.sanitizedHtml[index] = this.sanitizer.bypassSecurityTrustHtml(item.data);
        item.expanded = false;
      });
      return;
    }

    const headingRegex = new RegExp(`(${query})`, "gi");
    const contentRegex = new RegExp(`>([^<]*)(${query})([^<]*)<`, "gi");

    this.whatsCoveredData?.benefits?.forEach((item, index) => {
      let match = false;

      /** ðŸ”¹ Headings */
      let heading = this.toTitleCaseIfAllCaps(item?.heading) || "";
      if (headingRegex.test(heading)) {
        heading = heading.replace(
          headingRegex,
          `<mark class="highlight">$1</mark>`
        );
        match = true;
      }
      // Always assign something so Angular can bind
      this.highlightedHeadings[index] = heading;

      /** ðŸ”¹ Data/content */
      let content = item.data || "";
      if (contentRegex.test(content)) {
        content = content.replace(
          contentRegex,
          (m, before, term, after) =>
            `>${before}<mark class="highlight">${term}</mark>${after}<`
        );
        match = true;
      }
      // Always assign sanitized HTML, even if unchanged
      this.sanitizedHtml[index] =
        this.sanitizer.bypassSecurityTrustHtml(content);

      /** ðŸ”¹ Expand if matched */
      item.expanded = match;
    });
  });
}
