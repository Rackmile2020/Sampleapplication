import { Router, NavigationStart, NavigationEnd, Event, ActivatedRouteSnapshot } from '@angular/router';

this.router.events.subscribe((event: Event) => {
  if (event instanceof NavigationStart) {
    const currentRoute = this.getRouteData(this.router.routerState.snapshot.root);
    if (currentRoute?.isMFE) {
      this.loading = true;
    }
  } else if (event instanceof NavigationEnd || event instanceof NavigationCancel || event instanceof NavigationError) {
    // optionally hide spinner later via child event
  }
});

// helper to get deepest child route data
getRouteData(route: ActivatedRouteSnapshot): any {
  while (route.firstChild) {
    route = route.firstChild;
  }
  returnÂ route.data;
}
